<% content_tag ||= :div   %>
<% state       ||= :short %>


<% categories = capture do %>
  <% if event.categories.any?%>
    <p class='categories'>
      <%= t ('.categories') %>:
      <%= event.categories.map do |category|%>
      <% link_to( category.name, refinery.calendar_category_path(category)) %>
      <% end.join(', ').html_safe %>
    </p>
  <% end %>
<% end %>



<%= content_tag_for content_tag, event do -%>

  <% if state == :short %>

    <time class="date" datetime="<%= event.from %>">
      <%= l(event.from, format: :calendar_simple) %>
    </time>
    <h1><%= link_to event.title, refinery.calendar_event_path(event) %></h1>
    <%= categories %>
    <p><%= event.excerpt %></p>

  <% else %>

      <h4><%= t('.details', default: 'Event Details') %></h4>
      <h5><%= @event.venue_name %></h5>

      <%= categories %>

      <p>
          <%= t('.from', default: 'From') %> <%= @event.from.strftime('%B %d, %Y %I:%M%p') %><br>
          <%= t('.to', default: 'To') %> <%= @event.to.strftime('%B %d, %Y %I:%M%p') %>
      </p>

      <% if @event.registration_link.present? %>
        <p><%= link_to t('.register', default: 'Register for this event'), @event.registration_link %></p>
      <% end -%>

      <% if @event.venue_address.present? %>
        <p><%= link_to t('.view_on_map', default: 'View it on a map'), "http://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q=#{CGI::escape(@event.venue.address)}&ie=UTF8&z=16" %></p>
      <% end -%>

      <div class="event_description">
        <h4><%= @event.excerpt %></h4>
        <%=raw @event.description %>
      </div>

  <% end %>

<% end -%>
